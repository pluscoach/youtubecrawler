# YouTube Analyzer 프로젝트 설정 가이드

이 문서는 프로젝트를 새 컴퓨터로 옮기거나 클론했을 때 발생할 수 있는 오류와 해결 방법을 정리한 것입니다.

## 목차
1. [사전 요구사항](#사전-요구사항)
2. [백엔드 설정](#백엔드-설정)
3. [프론트엔드 설정](#프론트엔드-설정)
4. [환경변수 설정](#환경변수-설정)
5. [서버 실행](#서버-실행)
6. [자주 발생하는 오류와 해결방법](#자주-발생하는-오류와-해결방법)

---

## 사전 요구사항

- **Python 3.10+** (3.14 테스트됨)
- **Node.js 18+**
- **npm** 또는 **yarn**
- Git

---

## 백엔드 설정

### 1. 패키지 설치

```bash
cd backend
python -m pip install -r requirements.txt
```

### 2. 패키지 설치 실패 시 (pyroaring 빌드 오류)

`pyroaring` 패키지는 C++ 컴파일이 필요합니다. Windows에서 Visual C++ Build Tools가 없으면 빌드에 실패합니다.

**오류 메시지:**
```
error: Microsoft Visual C++ 14.0 or greater is required.
Get it with "Microsoft C++ Build Tools": https://visualstudio.microsoft.com/visual-cpp-build-tools/
```

**해결 방법 1: Visual C++ Build Tools 설치** (권장)
- https://visualstudio.microsoft.com/visual-cpp-build-tools/ 에서 설치

**해결 방법 2: 개별 패키지 설치** (Build Tools 없이)

pyroaring 빌드 실패로 전체 설치가 중단될 때, 필요한 패키지를 개별적으로 설치합니다:

```bash
# 핵심 패키지 개별 설치
python -m pip install youtube-transcript-api
python -m pip install google-api-python-client
python -m pip install anthropic httpx python-multipart tavily-python

# Supabase 관련 (--no-deps로 의존성 문제 우회)
python -m pip install supabase --no-deps
python -m pip install postgrest realtime websockets
python -m pip install supabase-auth supabase-functions storage3 --no-deps

# pyiceberg 및 의존성 (storage3에서 필요)
python -m pip install pyiceberg --no-deps
python -m pip install cachetools sortedcontainers mmh3 fsspec strictyaml tenacity click rich pyjwt
```

### 3. 설치 확인

```bash
python -c "import fastapi; import anthropic; import supabase; print('All packages OK')"
```

---

## 프론트엔드 설정

### 1. 패키지 설치

```bash
cd frontend
npm install
```

### 2. lib/api.ts 파일 확인

`frontend/src/lib/api.ts` 파일이 없으면 생성해야 합니다.

**오류 메시지:**
```
Module not found: Can't resolve '@/lib/api'
```

**해결:** `frontend/src/lib/api.ts` 파일 생성 (프로젝트에 이미 포함되어 있어야 함)

필요한 export 목록:
- `analyzeVideo(url: string)`
- `getAnalysisResult(id: string)`
- `getResult(id: string)` - getAnalysisResult의 alias
- `getHistory(limit, offset)`
- `deleteHistory(id: string)`
- `getPerspectives()`
- `analyzeCritical(analysisId, perspective)`
- `analyzeAdditional(analysisId)`
- Type: `HistoryItem`, `AnalysisResult`, `PerspectiveInfo` 등

---

## 환경변수 설정

### backend/.env 파일 생성

```bash
# backend/.env
ANTHROPIC_API_KEY=your_anthropic_api_key_here
YOUTUBE_API_KEY=your_youtube_api_key_here
SUPABASE_URL=your_supabase_url_here
SUPABASE_KEY=your_supabase_service_role_key_here
TAVILY_API_KEY=your_tavily_api_key_here
```

**API 키 발급처:**
- Anthropic: https://console.anthropic.com/settings/keys
- YouTube: https://console.cloud.google.com/apis/credentials
- Supabase: https://supabase.com/dashboard (Project Settings > API)
- Tavily: https://tavily.com/

---

## 서버 실행

### 백엔드 서버

```bash
cd backend
python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```

**확인:** http://localhost:8000 접속 시 아래 응답이 나오면 성공
```json
{"message":"YouTube Analyzer API","version":"1.0.0","docs":"/docs"}
```

### 프론트엔드 서버

```bash
cd frontend
npm run dev
```

**확인:** http://localhost:3000 접속

---

## 자주 발생하는 오류와 해결방법

### 1. ModuleNotFoundError: No module named 'youtube_transcript_api'

**원인:** 백엔드 패키지 미설치

**해결:**
```bash
python -m pip install youtube-transcript-api
```

### 2. ModuleNotFoundError: No module named 'googleapiclient'

**원인:** Google API 클라이언트 미설치

**해결:**
```bash
python -m pip install google-api-python-client
```

### 3. ModuleNotFoundError: No module named 'postgrest'

**원인:** Supabase 의존성 미설치

**해결:**
```bash
python -m pip install postgrest realtime websockets
```

### 4. ModuleNotFoundError: No module named 'pyiceberg'

**원인:** storage3 의존성 미설치

**해결:**
```bash
python -m pip install pyiceberg --no-deps
python -m pip install cachetools sortedcontainers mmh3 fsspec strictyaml tenacity rich
```

### 5. Module not found: Can't resolve '@/lib/api'

**원인:** 프론트엔드 lib/api.ts 파일 누락

**해결:** `frontend/src/lib/api.ts` 파일 생성 또는 Git에서 pull

### 6. TypeError: getResult is not a function

**원인:** lib/api.ts에 getResult 함수가 없음

**해결:** lib/api.ts에 아래 추가:
```typescript
export const getResult = getAnalysisResult;
```

### 7. Supabase URL and Key must be set in environment variables

**원인:** backend/.env 파일 없음 또는 환경변수 미설정

**해결:** backend/.env 파일 생성 및 SUPABASE_URL, SUPABASE_KEY 설정

### 8. Anthropic API 인증 오류: API 키를 확인해주세요

**원인:** ANTHROPIC_API_KEY가 유효하지 않거나 만료됨

**해결:**
1. backend/.env 파일에서 ANTHROPIC_API_KEY 확인
2. https://console.anthropic.com/settings/keys 에서 새 키 발급
3. 백엔드 서버 재시작

### 9. 'next' is not recognized as an internal or external command

**원인:** 프론트엔드 node_modules 미설치

**해결:**
```bash
cd frontend
npm install
```

### 10. pyroaring 빌드 실패

**원인:** Visual C++ Build Tools 미설치

**해결:**
- 옵션 1: https://visualstudio.microsoft.com/visual-cpp-build-tools/ 설치
- 옵션 2: 위의 "개별 패키지 설치" 방법 사용

---

## 전체 설정 체크리스트

- [ ] Python 3.10+ 설치됨
- [ ] Node.js 18+ 설치됨
- [ ] backend/.env 파일 생성됨
- [ ] 백엔드 패키지 설치됨 (`python -m pip install -r requirements.txt`)
- [ ] 프론트엔드 패키지 설치됨 (`npm install`)
- [ ] frontend/src/lib/api.ts 파일 존재함
- [ ] 백엔드 서버 실행됨 (http://localhost:8000)
- [ ] 프론트엔드 서버 실행됨 (http://localhost:3000)

---

## 빠른 설정 (한 줄 명령어)

### Windows (PowerShell)

```powershell
# 백엔드
cd backend
python -m pip install youtube-transcript-api google-api-python-client anthropic httpx python-multipart tavily-python
python -m pip install supabase postgrest realtime websockets supabase-auth supabase-functions storage3 pyiceberg cachetools sortedcontainers mmh3 fsspec strictyaml tenacity rich pyjwt --no-deps

# 프론트엔드
cd ../frontend
npm install
```

### 서버 동시 실행 (터미널 2개 필요)

**터미널 1 (백엔드):**
```bash
cd backend && python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```

**터미널 2 (프론트엔드):**
```bash
cd frontend && npm run dev
```

---

*마지막 업데이트: 2026-01-08*
